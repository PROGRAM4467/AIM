<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Multi-Mode (Math & Kelas 6)</title>
  <style>
    :root {
      --bg: #0b1020;
      --card: #121834;
      --accent: #6ee7b7;
      --text: #e6ecff;
      --muted: #99a2c7;
      --danger: #ff6b6b;
    }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: grid;
      place-items: center;
      padding: 24px;
    }
    .app {
      width: 100%; max-width: 840px; background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 24px; padding: 20px; backdrop-filter: blur(6px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      position: relative;
    }
    .header { display:flex; justify-content: space-between; align-items:center; }
    .title { display:flex; gap:12px; align-items:center; }
    .logo { width:42px; height:42px; border-radius:12px; display:grid; place-items:center; background: #0f1430; border:1px solid rgba(255,255,255,.08); }
    .logo span { font-weight: 800; color: var(--accent); }
    h1 { font-size: 22px; margin: 0; }
    .sub { color: var(--muted); font-size: 13px; margin-top: 2px; }

    /* Hamburger menu */
    .menu-btn { cursor:pointer; width:32px; height:24px; display:flex; flex-direction:column; justify-content:space-between; }
    .menu-btn span { display:block; height:4px; background:var(--text); border-radius:2px; }
    .menu { position:absolute; top:60px; right:20px; background:var(--card); border:1px solid rgba(255,255,255,0.08); border-radius:12px; padding:10px; display:none; }
    .menu button { display:block; width:100%; background:transparent; border:none; color:var(--text); padding:8px 12px; text-align:left; cursor:pointer; }
    .menu button:hover { background:rgba(255,255,255,0.08); }

    .row { display:grid; grid-template-columns: 1fr auto; gap: 12px; margin-top: 14px; }
    textarea {
      width: 100%; min-height: 90px; resize: vertical; border-radius: 16px; padding: 14px 16px; font-size: 16px;
      color: var(--text); background: var(--card); border: 1px solid rgba(255,255,255,0.08);
    }
    .btn { align-self:start; height:44px; padding:0 16px; border-radius:12px; border:none; font-weight:700;
      background:linear-gradient(180deg, var(--accent), #48cfa0); color:#032014; cursor:pointer; }
    .btn:active { transform: translateY(1px); }

    .result { margin-top: 16px; background: var(--card); border: 1px solid rgba(255,255,255,0.08); border-radius: 16px; padding: 14px 16px; white-space: pre-line; }
    .error { color: var(--danger); font-weight: 700; }
  </style>
</head>
<body>
  <div class="app">
    <div class="header">
      <div class="title">
        <div class="logo"><span>AI</span></div>
        <div>
          <h1 id="modeTitle">AI Pemecah Soal Matematika</h1>
          <div class="sub" id="modeSub">Mode: Kalkulator Matematika</div>
        </div>
      </div>
      <div class="menu-btn" id="menuBtn">
        <span></span><span></span><span></span>
      </div>
      <div class="menu" id="menu">
        <button data-mode="math">AI Matematika</button>
        <button data-mode="kelas6-math">AI Kelas 6 - Matematika</button>
        <button data-mode="kelas6-eng">AI Kelas 6 - Bahasa Inggris</button>
      </div>
    </div>

    <div class="row">
      <textarea id="expr" placeholder="Tulis soal di sini…"></textarea>
      <button class="btn" id="solve">Solve ➜</button>
    </div>

    <div id="out" class="result" hidden></div>
    <div id="err" class="result error" hidden></div>
  </div>

  <script>
    const menuBtn = document.getElementById('menuBtn');
    const menu = document.getElementById('menu');
    const modeTitle = document.getElementById('modeTitle');
    const modeSub = document.getElementById('modeSub');
    const expr = document.getElementById('expr');
    const out = document.getElementById('out');
    const err = document.getElementById('err');
    let currentMode = 'math';

    // Peta untuk mengganti simbol Unicode pecahan ke bentuk a/b
    const fractionMap = {
      '½': '1/2',
      '⅓': '1/3',
      '⅔': '2/3',
      '¼': '1/4',
      '¾': '3/4',
      '⅕': '1/5',
      '⅖': '2/5',
      '⅗': '3/5',
      '⅘': '4/5',
      '⅙': '1/6',
      '⅚': '5/6',
      '⅛': '1/8',
      '⅜': '3/8',
      '⅝': '5/8',
      '⅞': '7/8'
    };

    function normalizeInput(input){
      let q = input.trim();
      // Ganti simbol hp → js
      q = q.replace(/×/g,'*').replace(/÷/g,'/');
      // Ganti pecahan unicode → a/b
      for(const [sym, frac] of Object.entries(fractionMap)){
        q = q.replace(new RegExp(sym,'g'), frac);
      }
      return q;
    }

    menuBtn.addEventListener('click',()=>{
      menu.style.display = menu.style.display==='block' ? 'none' : 'block';
    });

    menu.querySelectorAll('button').forEach(btn=>{
      btn.addEventListener('click',()=>{
        currentMode = btn.dataset.mode;
        menu.style.display='none';
        if(currentMode==='math'){
          modeTitle.textContent = 'AI Pemecah Soal Matematika';
          modeSub.textContent = 'Mode: Kalkulator Matematika';
        } else if(currentMode==='kelas6-math'){
          modeTitle.textContent = 'AI Kelas 6 - Matematika';
          modeSub.textContent = 'Mode: Belajar Matematika SD Kelas 6 (termasuk Volume Kubus/Balok dll)';
        } else if(currentMode==='kelas6-eng'){
          modeTitle.textContent = 'AI Kelas 6 - Bahasa Inggris';
          modeSub.textContent = 'Mode: Belajar Bahasa Inggris SD Kelas 6';
        }
        expr.value='';
        out.hidden=true; err.hidden=true;
      });
    });

    document.getElementById('solve').addEventListener('click',()=>{
      err.hidden=true; out.hidden=true;
      let q = expr.value;
      if(!q){ err.textContent='⚠️ Tolong isi soal'; err.hidden=false; return; }
      q = normalizeInput(q.toLowerCase());

      if(currentMode==='math'){
        try{
          // Evaluasi pecahan dengan math.js style pakai Function
          let result = eval(q);
          if(Number.isFinite(result)){
            // Jika desimal panjang, coba sederhanakan jadi pecahan
            if(!Number.isInteger(result)){
              function toFraction(x){
                const tolerance = 1.0E-10;
                let h1=1, h2=0, k1=0, k2=1, b=x;
                do {
                  let a = Math.floor(b);
                  let aux = h1; h1 = a*h1+h2; h2 = aux;
                  aux = k1; k1 = a*k1+k2; k2 = aux;
                  b = 1/(b-a);
                } while (Math.abs(x-h1/k1) > x*tolerance);
                return h1+"/"+k1;
              }
              out.textContent = 'Jawaban: ' + toFraction(result);
            } else {
              out.textContent = 'Jawaban: ' + result;
            }
          } else {
            out.textContent = 'Hasil tidak valid';
          }
          out.hidden=false;
        }catch(e){ err.textContent='⚠️ Ekspresi salah'; err.hidden=false; }
      }
      else if(currentMode==='kelas6-math'){
        if(q.includes('volume') || q.includes('v2')){
          let jawaban = '';
          if(q.includes('kubus')){
            jawaban = 'Rumus volume kubus = sisi × sisi × sisi.\nContoh: sisi = 4 cm → V = 4 × 4 × 4 = 64 cm³';
          } else if(q.includes('balok')){
            jawaban = 'Rumus volume balok = p × l × t.\nContoh: p=5, l=3, t=2 → V = 5 × 3 × 2 = 30 cm³';
          } else {
            jawaban = 'Volume bangun ruang umumnya dihitung dengan rumus tertentu, misalnya kubus atau balok.';
          }
          out.textContent = jawaban;
        }
        else if(q.includes('pecahan')){
          out.textContent = 'Contoh: 1/2 + 1/4 = 3/4';
        } else {
          out.textContent = 'AI Kelas 6 Matematika: Soal belum dikenali, coba sebutkan kata kunci seperti "volume kubus" atau "pecahan".';
        }
        out.hidden=false;
      }
      else if(currentMode==='kelas6-eng'){
        if(q.toLowerCase().includes('translate')){
          out.textContent = 'Misal: Translate "book" = "buku"';
        } else if(q.includes('verb')){
          out.textContent = 'Contoh verb (kata kerja): go, eat, write, read';
        } else {
          out.textContent = 'AI Kelas 6 Bahasa Inggris: Soal belum dikenali, coba gunakan kata kunci "translate" atau "verb".';
        }
        out.hidden=false;
      }
    });
  </script>
</body>
</html>
